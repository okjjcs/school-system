# 🔧 حل مشكلة تسجيل الدخول للمعلمين الجدد

## 🎯 **المشكلة:**
عند إنشاء معلم جديد، لا يمكن تسجيل الدخول باسم المستخدم وكلمة المرور الجديدة.

## 🔍 **الأسباب المحتملة:**

### 1. **مشكلة في تشفير كلمة المرور**
- كلمة المرور قد تكون محفوظة بدون تشفير
- أو هناك مشكلة في عملية التحقق

### 2. **مشكلة في قاعدة البيانات**
- المستخدم غير نشط (`is_active = 0`)
- مشكلة في الاتصال بقاعدة البيانات

## 🛠️ **الحلول:**

### **الحل الأول: تشغيل ملف التشخيص**

1. **انسخ المجلد إلى XAMPP:**
   ```
   من: D:\arch\
   إلى: C:\xampp\htdocs\school-system\
   ```

2. **شغل Apache في XAMPP**

3. **اذهب إلى ملف التشخيص:**
   ```
   http://localhost/school-system/debug_login.php
   ```

4. **اختبر تسجيل الدخول** بالمعلم الجديد

### **الحل الثاني: تشغيل ملف الإصلاح**

1. **اذهب إلى ملف الإصلاح:**
   ```
   http://localhost/school-system/fix_login_issue.php
   ```

2. **سيقوم الملف بإصلاح جميع كلمات المرور تلقائياً**

3. **اختبر تسجيل الدخول بعد الإصلاح**

### **الحل الثالث: إصلاح يدوي**

إذا لم تعمل الحلول السابقة، يمكنك:

1. **تسجيل الدخول كمدير:**
   - اسم المستخدم: `admin`
   - كلمة المرور: `admin123`

2. **إضافة معلم جديد من جديد**

3. **استخدام كلمة مرور بسيطة مثل:** `123456`

## 🔧 **خطوات التشخيص:**

### **1. تحقق من وجود المستخدم:**
```sql
SELECT * FROM users WHERE username = 'اسم_المستخدم';
```

### **2. تحقق من حالة المستخدم:**
```sql
SELECT username, is_active, role FROM users WHERE username = 'اسم_المستخدم';
```

### **3. تحقق من تشفير كلمة المرور:**
- كلمة المرور المشفرة تبدأ بـ `$2y$`
- إذا كانت لا تبدأ بهذا، فهي غير مشفرة

## 📋 **خطوات الاختبار:**

### **1. إنشاء معلم جديد:**
- اذهب إلى: `http://localhost/school-system/teachers/add.php`
- أدخل البيانات المطلوبة
- استخدم كلمة مرور بسيطة مثل: `123456`

### **2. اختبار تسجيل الدخول:**
- اذهب إلى: `http://localhost/school-system/login.php`
- أدخل اسم المستخدم وكلمة المرور
- إذا لم يعمل، استخدم ملف التشخيص

### **3. استخدام ملف التشخيص:**
```
http://localhost/school-system/debug_login.php
```

## 🎯 **الحل السريع:**

### **إذا كنت تريد حلاً سريعاً:**

1. **شغل ملف الإصلاح:**
   ```
   http://localhost/school-system/fix_login_issue.php
   ```

2. **سيقوم بإصلاح جميع كلمات المرور**

3. **جرب تسجيل الدخول مرة أخرى**

## ⚠️ **ملاحظات مهمة:**

### **1. أمان الملفات:**
- احذف `debug_login.php` و `fix_login_issue.php` بعد الانتهاء
- هذه الملفات للتشخيص فقط

### **2. كلمات المرور:**
- استخدم كلمات مرور قوية في الإنتاج
- تأكد من تشفير جميع كلمات المرور

### **3. قاعدة البيانات:**
- تأكد من أن المسار صحيح
- تأكد من صلاحيات الكتابة

## 🚀 **بعد الإصلاح:**

### **1. اختبر النظام:**
- تسجيل دخول المدير
- إضافة معلم جديد
- تسجيل دخول المعلم الجديد

### **2. تأكد من الوظائف:**
- عرض الملف الشخصي
- إضافة تحضيرات
- إضافة أنشطة

## 📞 **إذا استمرت المشكلة:**

1. **تحقق من رسائل الخطأ في:**
   - ملف error.log في Apache
   - رسائل الخطأ في المتصفح

2. **تأكد من:**
   - تشغيل Apache
   - وجود قاعدة البيانات
   - صحة المسارات

3. **استخدم ملف التشخيص** لمعرفة السبب الدقيق

---

## ✅ **الخلاصة:**

**المشكلة الأكثر شيوعاً هي عدم تشفير كلمة المرور بشكل صحيح.**

**الحل الأسرع هو تشغيل ملف الإصلاح الذي سيحل المشكلة تلقائياً.**
